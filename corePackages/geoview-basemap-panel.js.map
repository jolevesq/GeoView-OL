{"version":3,"file":"corePackages/geoview-basemap-panel.js","mappings":"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","sources":["webpack://geoview-core/../geoview-basemap-panel/src/basemap-panel.tsx","webpack://geoview-core/../geoview-basemap-panel/src/index.tsx"],"sourcesContent":["import { TypeBasemapProps, TypeBasemapOptions, TypeJsonObject, TypeWindow } from 'geoview-core';\n\nconst w = window as TypeWindow;\n\ninterface BaseMapPanelProps {\n  mapId: string;\n  config: TypeJsonObject;\n}\n\nexport function BasemapPanel(props: BaseMapPanelProps): JSX.Element {\n  const { mapId, config } = props;\n\n  const { cgpv } = w;\n\n  const { api, react, ui } = cgpv;\n\n  const { useState, useEffect, useCallback } = react;\n\n  const useStyles = ui.makeStyles(() => ({\n    listContainer: {\n      overflowY: 'scroll',\n      height: '600px',\n    },\n    card: {\n      boxShadow: '0 4px 8px 0 rgba(0, 0, 0, 0.2)',\n      transition: '0.3s',\n      borderRadius: '5px',\n      '&:hover': {\n        boxShadow: '0 8px 16px 0 rgba(0, 0, 0, 0.2)',\n      },\n      marginBottom: 10,\n      height: '250px',\n      width: '100%',\n      display: 'block',\n      position: 'relative',\n    },\n    thumbnail: {\n      borderRadius: '5px',\n      position: 'absolute',\n      height: '100%',\n      width: '100%',\n      opacity: 0.8,\n    },\n    container: {\n      background: 'rgba(0,0,0,.68)',\n      color: '#fff',\n      overflow: 'hidden',\n      textOverflow: 'ellipsis',\n      height: '40px',\n      display: 'flex',\n      alignItems: 'center',\n      padding: '0 5px',\n      boxSizing: 'border-box',\n      position: 'absolute',\n      left: 0,\n      bottom: 0,\n      width: 'inherit',\n    },\n  }));\n\n  const [basemapList, setBasemapList] = useState<TypeBasemapProps[]>([]);\n\n  const classes = useStyles();\n\n  /**\n   * Update the basemap with the layers on the map\n   *\n   * @param {string} id update the basemap on the map\n   */\n  const setBasemap = (id: string) => {\n    api.map(mapId).basemap.setBasemap(id);\n  };\n\n  const addBasemaps = async () => {\n    // reset the basemaps array\n    api.map(mapId).basemap.basemaps = [];\n\n    // get existing basemaps\n    const { basemaps } = api.map(mapId).basemap;\n\n    // create the core basemap\n    for (let basemapIndex = 0; basemapIndex < config.coreBasemaps.length; basemapIndex++) {\n      const basemapOptions = config.coreBasemaps[basemapIndex] as TypeJsonObject;\n      // eslint-disable-next-line no-await-in-loop\n      const basemap = await api.map(mapId).basemap.createCoreBasemap(basemapOptions as unknown as TypeBasemapOptions);\n      if (basemap) setBasemapList((prevArray) => [...prevArray, basemap]);\n    }\n\n    // create the custom config basemap\n    for (let basemapIndex = 0; basemapIndex < config.customBasemaps.length; basemapIndex++) {\n      const customBasemap = config.customBasemaps[basemapIndex] as TypeJsonObject;\n      const basemap = api.map(mapId).basemap.createCustomBasemap(customBasemap as unknown as TypeBasemapProps);\n      if (basemap) setBasemapList((prevArray) => [...prevArray, basemap]);\n    }\n  };\n\n  /**\n   * load existing basemaps and create new basemaps\n   */\n  useEffect(() => {\n    addBasemaps();\n  }, []);\n\n  return (\n    <div className={classes.listContainer}>\n      {basemapList.map((basemap: TypeBasemapProps) => {\n        return (\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className={classes.card}\n            onClick={() => setBasemap(basemap.id as string)}\n            onKeyPress={() => setBasemap(basemap.id as string)}\n            key={basemap.id}\n          >\n            {typeof basemap.thumbnailUrl === 'string' && (\n              <img src={basemap.thumbnailUrl} alt={basemap.altText} className={classes.thumbnail} />\n            )}\n            {Array.isArray(basemap.thumbnailUrl) &&\n              basemap.thumbnailUrl.map((thumbnail, index) => {\n                // eslint-disable-next-line react/no-array-index-key\n                return <img key={index} src={thumbnail} alt={basemap.altText} className={classes.thumbnail} />;\n              })}\n            <div className={classes.container}>{basemap.name}</div>\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n","import {\n  Cast,\n  AbstractPluginClass,\n  TypePluginOptions,\n  TypeButtonProps,\n  TypeButtonPanel,\n  TypeWindow,\n  toJsonObject,\n  TypePanelProps,\n  TypeSchemaObject,\n  TypeJsonObject,\n} from 'geoview-core';\nimport { BasemapPanel } from './basemap-panel';\n\nimport schema from '../schema.json';\nimport defaultConfig from '../default-config-basemap-panel.json';\n\nconst w = window as TypeWindow;\n\n/**\n * Create a class for the plugin instance\n */\nclass BasemapPanelPlugin extends AbstractPluginClass {\n  // store the created button panel object\n  buttonPanel: TypeButtonPanel | null;\n\n  constructor(id: string, props: TypePluginOptions) {\n    super(id, props);\n    this.buttonPanel = null;\n  }\n\n  /**\n   * Return the package schema\n   *\n   * @returns {TypeSchemaObject} the package schema\n   */\n  schema = (): TypeSchemaObject => schema;\n\n  /**\n   * Return the default config for this package\n   *\n   * @returns {TypeJsonObject} the default config\n   */\n  defaultConfig = (): TypeJsonObject => toJsonObject(defaultConfig);\n\n  /**\n   * translations object to inject to the viewer translations\n   */\n  translations = toJsonObject({\n    'en-CA': {\n      basemapPanel: 'Basemaps',\n    },\n    'fr-CA': {\n      basemapPanel: 'Fond de carte',\n    },\n  });\n\n  /**\n   * Added function called after the plugin has been initialized\n   */\n  added = (): void => {\n    const { configObj, pluginProps } = this;\n\n    const { mapId } = pluginProps;\n\n    // access the cgpv object from the window object\n    const { cgpv } = w;\n\n    if (cgpv) {\n      // access the api calls\n      const { api } = cgpv;\n\n      const { language } = api.map(mapId);\n\n      // button props\n      const button: TypeButtonProps = {\n        tooltip: this.translations[language].basemapPanel as string,\n        tooltipPlacement: 'right',\n        icon: '<i class=\"material-icons\">map</i>',\n        type: 'textWithIcon',\n      };\n\n      // panel props\n      const panel: TypePanelProps = {\n        title: this.translations[language].basemapPanel,\n        icon: '<i class=\"material-icons\">map</i>',\n        width: 200,\n        status: configObj?.isOpen as boolean,\n      };\n\n      // create a new button panel on the appbar\n      this.buttonPanel = api.map(mapId).appBarButtons.createAppbarPanel(button, panel, null);\n\n      // set panel content\n      this.buttonPanel?.panel?.changeContent(<BasemapPanel mapId={mapId} config={configObj || {}} />);\n    }\n  };\n\n  /**\n   * Function called when the plugin is removed, used for clean up\n   */\n  removed(): void {\n    const { mapId } = this.pluginProps;\n\n    // access the cgpv object from the window object\n    const { cgpv } = w;\n\n    if (cgpv) {\n      // access the api calls\n      const { api } = cgpv;\n\n      if (this.buttonPanel) {\n        api.map(mapId).appBarButtons.removeAppbarPanel(this.buttonPanel.id);\n\n        // reset basemaps array\n        api.map(mapId).basemap.basemaps = [];\n        // reload default basemap\n        api.map(mapId).basemap.loadDefaultBasemaps(api.map(mapId).basemap.basemapOptions);\n      }\n    }\n  }\n}\n\nexport default BasemapPanelPlugin;\n\nw.plugins = w.plugins || {};\nw.plugins['basemap-panel'] = Cast<AbstractPluginClass>(BasemapPanelPlugin);\n"],"names":["w","window","BasemapPanel","props","mapId","config","cgpv","api","react","ui","useState","useEffect","useStyles","useCallback","makeStyles","listContainer","overflowY","height","card","boxShadow","transition","borderRadius","marginBottom","width","display","position","thumbnail","opacity","container","background","color","overflow","textOverflow","alignItems","padding","boxSizing","left","bottom","basemapList","setBasemapList","classes","setBasemap","id","map","basemap","addBasemaps","basemaps","basemapIndex","basemapOptions","coreBasemaps","createCoreBasemap","prevArray","length","customBasemap","customBasemaps","createCustomBasemap","className","role","tabIndex","onClick","onKeyPress","thumbnailUrl","src","alt","altText","Array","isArray","index","name","BasemapPanelPlugin","schema","toJsonObject","defaultConfig","basemapPanel","configObj","pluginProps","language","button","tooltip","translations","tooltipPlacement","icon","type","panel","title","status","isOpen","buttonPanel","appBarButtons","createAppbarPanel","changeContent","this","removeAppbarPanel","loadDefaultBasemaps","AbstractPluginClass","plugins","Cast"],"sourceRoot":""}